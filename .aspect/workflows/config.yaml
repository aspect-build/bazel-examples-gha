# See https://docs.aspect.build/workflows/configuration
tasks:
  - configure:
  - checkout:
      update_strategy: rebase
  - lint:
  - format:
  - test:
      targets:
        - //...
        - -//speller/...
        - -//.circleci/...
        - -//angular/projects/...
      bazel:
        flags:
          -  --test_tag_filters=-skip-on-aspect-workflows
      coverage:
        codecov_upload: true
  - delivery:
      auto_deliver: true
      stamp_flags:
        - --config=release
      rules:
        - deliverable: 'kind("gha_delivery_trigger rule", //...)'
          condition:
            branches:
              - main
              - 'release-.*'
              - gha_trigger_delivery_rule

notifications:
  github: {}
